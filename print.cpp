#include <iostream>
#include <Windows.h>
#include <thread>
#include <string>
#define ASLR(x) (x - 0x0)

using namespace std;
void console(const char* title) {
	DWORD old;
	VirtualProtect(reinterpret_cast<PVOID>(&FreeConsole), 1, PAGE_EXECUTE_READWRITE, &old);
	*reinterpret_cast<std::uint8_t*>(&FreeConsole) = 0xC3;
	VirtualProtect(&FreeConsole, 1, old, &old);
	AllocConsole();
	SetConsoleTitleA(title);
	FILE* file_stream;
	freopen_s(&file_stream, "CONOUT$", "w", stdout);
	freopen_s(&file_stream, "CONOUT$", "w", stderr);
	freopen_s(&file_stream, "CONIN$", "r", stdin);
}
void main_thread()
{
	console("fuckers");

	
	const auto print = reinterpret_cast<int(__cdecl*)(int, const char*, ...)>(reinterpret_cast<std::uintptr_t>(GetModuleHandle(nullptr)) + ASLR(0xC34AB0));

	int typ;
	string pr;
	bool t = true;
	cout << "types are, normal=0, warn=1, error=2, info=3";
	do{
		cout << "Type";
		cin >> typ;
		cout << "Text";
		cin >> pr;
		if (pr == "stop" or "Stop") {
			break;
		}
		else {
			const char* v = pr.c_str();
			print(typ, v);
			print(1, "--------------------------------------------------------");
			print(3, "If you want to stop the loop say in the console stop");
			print(1, "--------------------------------------------------------");
		}
		
		
		
	} while (t);
	
}

bool __stdcall DllMain(void*, const std::uintptr_t reason, void*)
{
	if (reason == 1)
	{
		std::thread(main_thread).detach();
	}
	return 1;
}
