#include <iostream>
#include <Windows.h>
#include <thread>
#include <string>
#define ASLR(x) (x - 0x0)

using namespace std;
void console(const char* title) {
	DWORD old;
	VirtualProtect(reinterpret_cast<PVOID>(&FreeConsole), 1, PAGE_EXECUTE_READWRITE, &old);
	*reinterpret_cast<std::uint8_t*>(&FreeConsole) = 0xC3;
	VirtualProtect(&FreeConsole, 1, old, &old);
	AllocConsole();
	SetConsoleTitleA(title);
	FILE* file_stream;
	freopen_s(&file_stream, "CONOUT$", "w", stdout);
	freopen_s(&file_stream, "CONOUT$", "w", stderr);
	freopen_s(&file_stream, "CONIN$", "r", stdin);
}
void main_thread()
{
	console("fuckers");
	
	
	const auto print = reinterpret_cast<int(__cdecl*)(int, const char*, ...)>(reinterpret_cast<std::uintptr_t>(GetModuleHandle(nullptr)) + ASLR(0xC34AB0));

	int typ;
	string pr;
	string k;
	bool t = true;

	cout << "types are, normal = 0, warn = 1, info = 2, error = 3\n";
	do{
		cout << "Type ";
		cin >> typ;
		cout << "Text ";
		cin >> pr;
		const char* v = pr.c_str();
		print(typ, v);

	} while (t);
	
}

bool __stdcall DllMain(void*, const std::uintptr_t reason, void*)
{
	if (reason == 1)
	{
		std::thread(main_thread).detach();
	}
	return 1;
}
